/**
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
*/

"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}angular.module("common.baselayer.control",["geo.maphelper","geo.map","ui.bootstrap-slider"]).directive("commonBaselayerControl",["mapHelper","mapService",function(t,e){var n={maxZoom:12};return{template:'<slider ui-tooltip="hide" min="0" max="1" step="0.1" ng-model="slider.opacity" updateevent="slideStop"></slider>',scope:{maxZoom:"="},link:function(a,o){"undefined"==typeof a.maxZoom&&(a.maxZoom=n.maxZoom),a.slider={opacity:-1,visibility:!0,lastOpacity:1},t.getPseudoBaseLayer().then(function(t){a.layer=t,a.slider.opacity=t.options.opacity}),a.$watch("slider.opacity",function(t,n){n<0||e.getMap().then(function(t){t.eachLayer(function(t){t.pseudoBaseLayer&&t.setOpacity(a.slider.opacity)})})})}}}]),angular.module("common.accordion",["ui.bootstrap.collapse"]).constant("commonAccordionConfig",{closeOthers:!0}).controller("commonAccordionController",["$scope","$attrs","commonAccordionConfig",function(t,e,n){this.groups=[],this.closeOthers=function(a){var o=angular.isDefined(e.closeOthers)?t.$eval(e.closeOthers):n.closeOthers;o&&angular.forEach(this.groups,function(t){t!==a&&(t.isOpen=!1)})},this.addGroup=function(t){var e=this;this.groups.push(t),t.$on("$destroy",function(n){e.removeGroup(t)})},this.removeGroup=function(t){var e=this.groups.indexOf(t);e!==-1&&this.groups.splice(e,1)}}]).directive("commonAccordion",function(){return{controller:"commonAccordionController",controllerAs:"accordion",transclude:!0,templateUrl:function(t,e){return e.templateUrl||"common/accordion/accordion.html"}}}).directive("commonAccordionGroup",function(){return{require:"^commonAccordion",transclude:!0,restrict:"A",templateUrl:function(t,e){return e.templateUrl||"common/accordion/accordionGroup.html"},scope:{heading:"@",panelClass:"@?",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(t){this.heading=t}},link:function(t,e,n,a){e.addClass("panel"),a.addGroup(t),t.openClass=n.openClass||"panel-open",t.panelClass=n.panelClass||"panel-default",t.$watch("isOpen",function(n){e.toggleClass(t.openClass,!!n),n&&a.closeOthers(t)}),t.toggleOpen=function(e){t.isDisabled||e&&32!==e.which||(t.isOpen=!t.isOpen)};var o="accordiongroup-"+t.$id+"-"+Math.floor(1e4*Math.random());t.headingId=o+"-tab",t.panelId=o+"-panel"}}}).directive("commonAccordionHeading",function(){return{transclude:!0,template:"",replace:!0,require:"^commonAccordionGroup",link:function(t,e,n,a,o){a.setHeading(o(t,angular.noop))}}}).directive("commonAccordionTransclude",function(){function t(){return"common-accordion-header,data-common-accordion-header,x-common-accordion-header,common\\:accordion-header,[common-accordion-header],[data-common-accordion-header],[x-common-accordion-header]"}return{require:"^commonAccordionGroup",link:function(e,n,a,o){e.$watch(function(){return o[a.commonAccordionTransclude]},function(e){if(e){var a=angular.element(n[0].querySelector(t()));a.html(""),a.append(e)}})}}}),angular.module("common.bbox",["geo.draw"]).directive("commonBboxShowAll",["$rootScope","$timeout",function(t,e){return{link:function(n,a){a.on("click",function(){e(function(){t.$broadcast("commonbboxshowall")})})}}}]).directive("commonBboxHideAll",["$rootScope",function(t){return{link:function(e,n){n.on("click",function(){t.$broadcast("commonbboxhideall")})}}}]).directive("commonBboxShowVisible",["$rootScope","mapService",function(t,e){return{link:function(n,a){a.on("click",function(){e.getMap().then(function(e){t.$broadcast("commonbboxshowvisible",e.getBounds())})})}}}]).directive("commonBbox",["$rootScope","bboxService",function(t,e){return{templateUrl:"common/bbox/bbox.html",scope:{data:"="},link:function(n,a){t.$on("commonbboxshowall",function(){n.data.hasBbox=!0}),t.$on("commonbboxhideall",function(){n.data.hasBbox=!1}),t.$on("commonbboxshowvisible",function(t,e){var a=n.data.bounds,o=e.getWest()<a.xMin&&e.getEast()>a.xMax&&e.getNorth()>a.yMax&&e.getSouth()<a.yMin;n.data.hasBbox=o}),n.$watch("data.hasBbox",function(t){t?e.draw(n.data).then(function(t){n.bbox=t}):n.bbox=e.remove(n.bbox)}),n.toggle=function(){n.data.hasBbox=!n.data.hasBbox},n.$on("$destroy",function(){n.data.hasBbox&&(n.bbox=e.remove(n.bbox))})}}}]).factory("bboxService",["mapService",function(t){var e="#ff7800";return{draw:function(n){var a=n.bbox.split(" "),o=[[+a[1],+a[0]],[+a[3],+a[2]]];return t.getMap().then(function(t){var n=L.rectangle(o,{fill:!1,color:e,weight:2,opacity:.8});return n.addTo(t),t.fitBounds(o),n})},remove:function(t){return t&&t._map.removeLayer(t),null}}}]);var versions={3:{version:"3.0",link:"https://creativecommons.org/licenses/by/3.0/au/"},4:{version:"4.0",link:"https://creativecommons.org/licenses/by/4.0/"}};angular.module("common.cc",[]).directive("commonCc",[function(){return{templateUrl:"common/cc/cc.html",scope:{version:"=?"},link:function(t){t.version?t.details=versions[t.version]:t.details=versions[4],t.template="common/cc/cctemplate.html"}}}]),function(t,e){function n(t){t.data().then(function(t){this.data=t}.bind(this)),this.remove=function(){t.clear()},this.changeEmail=function(e){t.setEmail(e)}}function a(t,e,n,a,o){var r="download_email",i="Download Layers",c={zoom:null,center:null,layer:null},s={email:null,item:null},l={getLayerGroup:function(){return a.getGroup(i)},setState:function(t){function e(){var e=[[t.bounds.yMin,t.bounds.xMin],[t.bounds.yMax,t.bounds.xMax]];c.layer&&a.getGroup(i).removeLayer(c.layer),t.queryLayer||(c.layer=L.rectangle(e,{color:"black",fill:!1}),a.getGroup(i).addLayer(c.layer))}function n(t){a.clearGroup(i),c.layer=null}t?e():n(map)},add:function(t){this.clear(),s.item=t,s.item.download=!0,t.processsing||(t.processing={clip:{xMax:null,xMin:null,yMax:null,yMin:null}})},clear:function(){s.item&&(s.item.download=!1,s.item=null)},setEmail:function(t){o.setItem(r,t)},getEmail:function(){return o.getItem(r).then(function(t){return s.email=t,t})},data:function(){return e.when(s)}};return l}t.module("common.download",["common.geoprocess"]).directive("wizardPopup",["downloadService",function(t){return{restrict:"AE",templateUrl:"common/download/popup.html",link:function(e){t.data().then(function(n){e.data=n,e.$watch("data.item",function(n,a){n&&(e.stage="bbox"),(n||a)&&t.setState(n)})})}}}]).directive("wizardDownload",["downloadService",function(t){return{restrict:"AE",controller:"DownloadCtrl",templateUrl:"common/download/popup.html",link:function(){console.log("What the download...")}}}]).directive("commonDownload",["downloadService",function(t){return{templateUrl:"common/download/download.html",controller:"DownloadCtrl",link:function(e,n){t.data().then(function(t){e.data=t}),e.$watch("data.item",function(e,n){(e||n)&&t.setState(e)})}}}]).directive("downloadAdd",["$rootScope","downloadService","flashService",function(t,e,n){return{template:"<button type='button' class='undecorated' ng-click='toggle()'><span class='fa-stack'  tooltip-placement='right' tooltip='Extract data.'><i class='fa fa-lg fa-download' ng-class='{active:item.download}'></i></span></button>",restrict:"AE",scope:{item:"=",group:"="},link:function(a,o){a.toggle=function(){a.group&&a.group.download?e.clear(a.item):(n.add("Select an area of interest that intersects the highlighted areas."),e.add(a.item),a.group&&a.group.sysId&&t.$broadcast("hide.wms",a.group.sysId))}}}}]).directive("downloadEmail",["downloadService",function(t){return{template:'<div class="input-group"><span class="input-group-addon" id="nedf-email">Email</span><input required="required" type="email" ng-change="download.changeEmail(email)" ng-model="email" class="form-control" placeholder="Email address to send download link" aria-describedby="nedf-email"></div>',restrict:"AE",link:function(e,n){t.getEmail().then(function(t){e.email=t})}}}]).directive("downloadFilename",["flashService","downloadService",function(t,e){return{template:'<div class="input-group"><span class="input-group-addon" id="nedf-filename">Filename</span><input type="text" ng-maxlength="30" ng-trim="true" ng-keypress="restrict($event)" ng-model="data.filename" class="form-control" placeholder="Optional filename" aria-describedby="nedf-filename"><span class="input-group-addon" id="basic-addon2">.zip</span></div><div>Only up to 9 characters made up of alphanumeric or "_" allowed for file name</div>',restrict:"AE",scope:{data:"="},link:function(e,n){var a;e.restrict=function(e){var n=e.keyCode,o=String.fromCharCode(n).toUpperCase();n>31&&!o.match(/[\_A-Z0-9]/gi)?(t.remove(a),a=t.add('Only alphanumeric characters or "_" allowed in filename.',5e3),e.preventDefault()):n>31&&e.currentTarget.value&&e.currentTarget.value.length>=9&&(t.remove(a),a=t.add("Filename is restricted to 9 characters.",5e3),e.preventDefault())}}}}]).controller("DownloadCtrl",n).factory("downloadService",a),n.$inject=["downloadService"],a.$inject=["$http","$q","$rootScope","mapService","storageService"]}(angular,$),angular.module("common.clip",["geo.draw"]).directive("wizardClip",["$timeout","clipService","flashService",function(t,e,n){return{templateUrl:"common/clip/clip.html",scope:{clip:"=",bounds:"=",trigger:"=",drawn:"&"},link:function(n,a){"undefined"==typeof n.showBounds&&(n.showBounds=!1),n.$watch("bounds",function(a){a&&n.trigger?t(function(){n.initiateDraw()}):a||e.cancelDraw()}),n.initiateDraw=function(){function t(t){var e,a=n.clip;a.xMax=+t.clip.xMax,a.xMin=+t.clip.xMin,a.yMax=+t.clip.yMax,a.yMin=+t.clip.yMin,n.drawn&&(e=n.drawn(),e&&e.code&&"oversize"===e.code&&n.initiateDraw())}e.initiateDraw().then(t)}}}}]).factory("clipService",["$q","$rootScope","drawService",function(t,e,n){function a(t){return{clip:{xMax:t.bounds.getEast().toFixed(5),xMin:t.bounds.getWest().toFixed(5),yMax:t.bounds.getNorth().toFixed(5),yMin:t.bounds.getSouth().toFixed(5)}}}return{initiateDraw:function(){return n.drawRectangle().then(a)},cancelDraw:function(){n.cancelDrawRectangle()}}}]),angular.module("common.draw",["geo.map"]).directive("commonDraw",["$log","$rootScope","commonDrawService",function(t,e,n){var a={rectangleEvent:"geo.draw.rectangle.created",lineEvent:"geo.draw.line.created"};return{restrict:"AE",scope:{data:"=",rectangleEvent:"@",lineEvent:"@"},link:function(t,e,o,r){angular.forEach(a,function(e,n){t[n]||(t[n]=e)}),n.createControl(t)}}}]).factory("commonDrawService",["$q","$rootScope","mapService",function(t,e,n){var a,o,r,i;return{createControl:function(r){return o&&t.when(o),n.getMap().then(function(t){var n=new L.FeatureGroup,c={edit:{featureGroup:n}};return r.data&&angular.extend(c,r.data),featureGroup=r.drawnItems=n,t.addLayer(n),o=new L.Control.Draw(c),t.addControl(o),t.on("draw:created",function(t){({polyline:function(){var n={length:t.layer.getLength(),geometry:t.layer.getLatLngs()};e.$broadcast(r.lineEvent,n)},rectangle:function(){var n={bounds:t.layer.getBounds(),options:a};i.resolve(n),i=null,e.$broadcast(r.rectangleEvent,n)}})[t.layerType]()}),o})},cancelDrawRectangle:function(){this.options={},i&&(i.reject(),i=null,r&&r.disable())},drawRectangle:function(e){return this.cancelDrawRectangle(),a=e,i=t.defer(),r?r.enable():n.getMap().then(function(t){r=new L.Draw.Rectangle(t,o.options.polyline),r.enable()}),i.promise}}}]),function(t){function e(t,e){function n(){t.getMap().then(function(t){t.on("moveend",a),t.on("zoomend",a),a()})}function a(){t.getMap().then(function(t){var n=t.getBounds();o.yMin=n.getSouth(),o.xMin=n.getWest(),o.yMax=n.getNorth(),o.xMax=n.getEast(),e.refresh()})}var o=e.getSearchCriteria().bbox;return o.fromMap&&n(),{getParameters:function(){return o}}}t.module("common.extent",["explorer.switch"]).directive("commonExtent",["extentService",function(t){return{restrict:"AE",templateUrl:"common/extent/extent.html",controller:["$scope",function(e){e.parameters=t.getParameters()}],link:function(t,e,n){}}}]).factory("extentService",e),e.$inject=["mapService","searchService"]}(angular),function(t,e){function n(t){var e=t.split(" - ");return 2!==e.length?t:a(e[0])+" - "+a(e[1])}function a(t){return 8!==t.length?t:t.substr(0,4)+"/"+t.substr(4,2)+"/"+t.substr(6,2)}t.module("common.featureinfo",[]).directive("commonFeatureInfo",["$http","$log","$q","$timeout","featureInfoService","flashService","messageService",function(o,r,i,c,s,l,d){var u="https://elvis2018-ga.fmecloud.com/fmedatastreaming/elvis_indexes/GetFeatureInfo_ElevationAvailableData.fmw?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetFeatureInfo&SRS=EPSG%3A4326&BBOX=${bounds}&WIDTH=${width}&HEIGHT=${height}&LAYERS=public.QLD_Elevation_Metadata_Index,public.ACT2015-Tile_Index_55,public.5dem_ProjectsIndex,public.NSW_100k_Index_54,public.NSW_100k_Index_55,public.NSW_100k_Index_56,public.NSW_100k_Index_Forward_Program,public.QLD_Project_Index_54,public.QLD_Project_Index_55,public.QLD_Project_Index_56,public.TAS_Project_Index_55,public.GA_Project_Index_47,public.GA_Project_Index_48,public.GA_Project_Index_54,public.GA_Project_Index_55,public.GA_Project_Index_56&STYLES=&INFO_FORMAT=application%2Fjson&FEATURE_COUNT=100&X=${x}&Y=${y}";return{require:"^geoMap",restrict:"AE",link:function(r,i,d,m){var p=null,h=!1;"undefined"==typeof r.options&&(r.options={}),m.getMap().then(function(r){r.on("popupclose",function(t){s.removeLastLayer(r)}),r.on("draw:drawstart",function(){h=!0,c(function(){h=!1},6e4)}),r.on("draw:drawstop",function(){h=!1}),r.on("click",function(i){var c=null,d=r.getSize(),m=r.latLngToContainerPoint(i.latlng,r.getZoom()),f=i.latlng,g={x:m.x,y:m.y,bounds:r.getBounds().toBBoxString(),height:d.y,width:d.x},v=u;h||(l.remove(p),p=l.add("Checking available data at this point",3e4,!0),t.forEach(g,function(t,e){v=v.replace("${"+e+"}",t)}),o.get(v).then(function(t){var o=t.data,i=void 0,d=[],u=[];console.log(o),r.closePopup(),s.removeLastLayer(r),l.remove(p),o.length?(i={data:{name:"public.AllIndexes",type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:4326"}},features:[]}},d=i.data.features,o.forEach(function(t){t.features.forEach(function(t){d.push(t);var e=["<span>"],o=t.properties;if(o.maptitle){var r=o.mapnumber?"Map number: "+o.mapnumber:"";e.push("<strong>Map Title:</strong> <span title='"+r+"'>"+o.maptitle)}if(o.project&&e.push("<strong>Project name:</strong> "+o.project),o.captured&&e.push("<br/><strong>Capture date:</strong> "+n(o.captured)),o.object_name?e.push("<strong>File name:</strong> "+o.object_name):o.object_name_ahd?e.push("<strong>File name:</strong> "+o.object_name_ahd):o.object_name_ort&&e.push("<strong>File name:</strong> "+o.object_name_ort),e.push("</span><br/><strong>Status:</strong> "+t.properties.status),o.available_date&&e.push("<br/><strong>Available date:</strong> "+a(o.available_date)),o.contact){var i=o.contact,c=0===i.toLowerCase().indexOf("mailto:")?"":"mailto:";e.push("<br/><strong>Contact:</strong> <a href='"+c+o.contact+"'>"+o.contact+"</a>")}o.metadata_url&&e.push("<br/><a href='"+o.metadata_url+"' target='_blank'>Metadata</a>"),u.push(e.join(" "))})})):(p=l.add("No status information available for this point.",4e3),i=t),d.length&&(c=e.geoJson(i.data,{style:function(t){return{fillOpacity:.1,color:"red"}}}).addTo(r),s.setLayer(c),e.popup().setLatLng(f).setContent("<div class='fi-popup'>"+u.join("<hr/>")+"</div>").openOn(r))}))})})}}}]).factory("featureInfoService",[function(){var t=null;return{setLayer:function(e){t=e},removeLastLayer:function(e){t&&(e.removeLayer(t),t=null)}}}])}(angular,L),function(t,e){function n(n,a,o,r,i,c,s){function l(t){var e,n,a;return d.custom&&(e=d.custom[t.primaryId],e&&(n=e.key,a=e.templates[t[n]]))?a:d["default"]}var d,u,m="dems1sv1_0",p=null;return r.getConfig("initiateServiceTemplates").then(function(t){d=t}),c.getMap().then(function(t){u=t}),{queryLayer:function(t,n){var o=a.defer(),r=e.esri.featureLayer({url:t.url}),i=e.latLngBounds([n.yMin,n.xMin],[n.yMax,n.xMax]);return r.query().intersects(i).ids(function(t,e){t?o.reject(t):o.resolve(e)}),o.promise},outFormats:function(){return r.getConfig("processing").then(function(t){return t.outFormat})},handleShowClip:function(t){this.removeClip(),p=e.rectangle([[t.yMin,t.xMin],[t.yMax,t.xMax]],{weight:2,opacity:.9,fill:!1,color:"#000000",width:3,clickable:!1}),p.addTo(u)},removeClip:function(){p&&(u.removeLayer(p),p=null)},addLayer:function(t){return e.tileLayer.wms(t.parameters[0],t.parameters[1]).addTo(u)},removeLayer:function(t){u.removeLayer(t)},initiateJob:function(e,n){var a=m,o=l(e),r=e.processing,c={bbox:{yMin:r.clip.yMin,yMax:r.clip.yMax,xMin:r.clip.xMin,xMax:r.clip.xMax},geocatId:e.primaryId,crs:r.outCoordSys.code,format:r.outFormat.code};t.forEach({basename:a,id:e.primaryId,yMin:r.clip.yMin,yMax:r.clip.yMax,xMin:r.clip.xMin,xMax:r.clip.xMax,outFormat:r.outFormat.code,outCoordSys:r.outCoordSys.code,filename:r.filename?r.filename:"",state:e.state?e.state:"",email:n},function(t,e){o=o.replace("${"+e+"}",t)}),$("#launcher")[0].src=o,i.setEmail(n),ga("send","event","nedf","click","FME data export: "+JSON.stringify(c))},getConfig:function(){return r.getConfig("processing")}}}t.module("common.geoprocess",[]).directive("wizardGeoprocess",["$http","$q","$timeout","geoprocessService","flashService","messageService",function(e,n,a,o,r,i){return{restrict:"AE",templateUrl:"common/geoprocess/geoprocess.html",scope:{data:"="},link:function(c){function s(){l(),c.data.referenceLayer&&(v=o.addLayer(c.data.referenceLayer))}function l(){v&&o.removeLayer(v)}function d(t){var e=(t.xMax-t.xMin)*(t.yMax-t.yMin);return e<1e-11||t.xMax<t.xMin}function u(t){var e=Math.abs((t.xMax-t.xMin)*(t.yMax-t.yMin));return c.data.restrictSize&&e>c.data.restrictSize}function m(e,n){function a(e){return t.isUndefined(e)||""===e||null===e}var o=!1,r=!1;return!(!n||a(e.xMax)||a(e.xMin)||a(e.yMax)||a(e.yMin))&&(r=o=+e.xMax<+n.xMin,o&&(e.xMax=+n.xMin),o=+e.xMax>+n.xMax,r=r||o,o&&(e.xMax=+n.xMax),o=+e.xMin<+n.xMin,r=r||o,o&&(e.xMin=+n.xMin),o=+e.xMin>+e.xMax,r=r||o,o&&(e.xMin=e.xMax),o=+e.yMax<+n.yMin,r=r||o,o&&(e.yMax=+n.yMin),o=+e.yMax>+n.yMax,r=r||o,o&&(e.yMax=+n.yMax),o=+e.yMin<+n.yMin,r=r||o,o&&(e.yMin=+n.yMin),o=+e.yMin>+e.yMax,r=r||o,o&&(e.yMin=+e.yMax),r)}function p(t){t.xMax=null===t.xMax?null:+t.xMax,t.xMin=null===t.xMin?null:+t.xMin,t.yMax=null===t.yMax?null:+t.yMax,t.yMin=null===t.yMin?null:+t.yMin}function h(e){return e&&t.isNumber(e.xMax)&&t.isNumber(e.xMin)&&t.isNumber(e.yMax)&&t.isNumber(e.yMin)&&!u(e)&&!d(e)}var f,g,v;o.outFormats().then(function(t){c.outFormats=t}),c.$watch("data",function(t,e){e&&(o.removeClip(),l()),t&&t!==e&&(c.stage="bbox",s())}),c.$watchGroup(["data.processing.clip.xMax","data.processing.clip.xMin","data.processing.clip.yMax","data.processing.clip.yMin"],function(t,c,l){function d(){var t=n.defer();if(u=l.drawn(),u&&u.code)switch(u.code){case"oversize":a(function(){r.remove(f),i.error("The selected area is too large to process. Please restrict to approximately "+Math.sqrt(l.data.restrictSize)+" degrees square."),l.stage="bbox",s(),t.resolve(u)});break;case"undersize":a(function(){r.remove(f),i.error("X Min and Y Min should be smaller than X Max and Y Max, respectively. Please update the drawn area."),l.stage="bbox",s(),t.resolve(u)});break;default:return n.when(u)}return t.promise}var u,m;g&&(a.cancel(g),g=null),l.data&&l.data.processing&&l.data.processing.clip&&null!==l.data.processing.clip.xMax&&(m=l.config.extentCheckTemplates[l.data.sysId],f=r.add("Validating selected area...",3e3),l.checkingOrFailed=!!m,g=a(function(){d().then(function(n){try{if(n&&"success"===n.code)if(m){var a=m.replace("{maxx}",t[0]).replace("{minx}",t[1]).replace("{maxy}",t[2]).replace("{miny}",t[3]);r.remove(f),f=r.add("Checking there is data in your selected area..."),e.get(a).then(function(t){t.data&&t.data.length>0&&(r.remove(f),t.data[0].Intersect===!1?(i.error("There is no data covering the drawn area currently in this resolution dataset.",6e3),l.stage="bbox",s()):(f=t.data[0].Intersect===!0?r.add('There is intersecting data. Click "Next" if you are ready to proceed.',5e3):r.add('Click "Next" if you are ready to proceed.',4e3),l.checkingOrFailed=!1,o.handleShowClip(l.data.processing.clip))),console.log(t)},function(t){l.checkingOrFailed=!1,o.handleShowClip(l.data.processing.clip),console.log("Service unavailable to check intersection")})}else o.handleShowClip(l.data.processing.clip),l.checkingOrFailed=!1}catch(c){l.checkingOrFailed=!1}})},2e3))}),c.drawn=function(){return o.removeClip(),p(c.data.processing.clip),m(c.data.processing.clip,c.data.bounds)&&(f=r.add("Redrawn to fit within data extent",5e3)),u(c.data.processing.clip)?{code:"oversize"}:d(c.data.processing.clip)?{code:"undersize"}:null===c.data.processing.clip.xMax?{code:"incomplete"}:h(c.data.processing.clip)?{code:"success"}:{code:"invalid"}},c.startExtract=function(){c.allDataSet()&&(i.info("Your request has been sent for processing. You will be notified by email on completion of the job."),r.add("You can select another area for processing.",1e4),o.initiateJob(c.data,c.email),c.data.download=!1)},c.allDataSet=function(){var t=c.data&&c.data.processing?c.data.processing:null;return t&&c.email&&h(t.clip)&&t.outCoordSys&&t.outFormat},c.validSansEmail=function(){var t=c.data&&c.data.processing?c.data.processing:null;return t&&h(t.clip)&&t.outCoordSys&&t.outFormat},c.validClip=function(t){return t&&t.processing&&h(t.processing.clip)},o.getConfig().then(function(t){c.config=t})}}}]).factory("geoprocessService",n).filter("sysIntersect",function(){return function(e,n){return n&&t.isNumber(n.xMin)&&t.isNumber(n.xMax)&&t.isNumber(n.yMin)&&t.isNumber(n.yMax)?e.filter(function(t){return!t.extent||t.extent.xMin<=n.xMin&&t.extent.xMax>=n.xMax&&t.extent.yMin<=n.yMin&&t.extent.yMax>=n.yMax}):e}}),n.$invoke=["$http","$q","$timeout","configService","downloadService","ga","mapService","storageService"]}(angular,L),function(t){t.module("common.header",[]).controller("headerController",["$scope","$q","$timeout",function(t,e,n){var a=function(t){return t};t.$on("headerUpdated",function(e,n){t.headerConfig=a(n)})}]).directive("icsmHeader",[function(){var e={current:"none",heading:"ICSM",headingtitle:"ICSM",helpurl:"help.html",helptitle:"Get help about ICSM",helpalttext:"Get help about ICSM",skiptocontenttitle:"Skip to content",skiptocontent:"Skip to content",quicklinksurl:"/search/api/quickLinks/json?lang=en-US"};return{transclude:!0,restrict:"EA",templateUrl:"common/header/header.html",scope:{current:"=",breadcrumbs:"=",heading:"=",headingtitle:"=",helpurl:"=",helptitle:"=",helpalttext:"=",skiptocontenttitle:"=",skiptocontent:"=",quicklinksurl:"="},link:function(n,a,o){t.copy(e);t.forEach(e,function(t,e){e in n||(n[e]=t)})}}}]).factory("headerService",["$http",function(){}])}(angular),function(t){function e(t){if(t.toUpperCase()==t)return t;var e=t.split("_"),n=e[e.length-1];return n.replace(/./,function(t){return t.toUpperCase()}).replace(/([A-Z])/g," $1").trim()}t.module("common.iso19115",["common.recursionhelper"]).directive("iso19115Metadata",[function(){return{templateUrl:"common/iso19115/metadata.html",scope:{node:"="}}}]).directive("iso19115Contact",[function(){return{templateUrl:"common/iso19115/contact.html",restrict:"AE",scope:{node:"="}}}]).directive("iso19115Double",[function(){return{templateUrl:"common/iso19115/double.html",restrict:"AE",scope:{node:"=",name:"@",type:"@"},link:function(t){t.node&&(t.value=t.node[t.name][t.type])}}}]).directive("iso19115Node",[function(){var t={CharacterString:function(t){return t&&t.CharacterString?t.CharacterString.__text:null},LanguageCode:function(t){return t&&t.LanguageCode?t.LanguageCode._codeListValue:null},MD_CharacterSetCode:function(t){return t&&t.MD_CharacterSetCode?t.LanguageCode._codeListValue:null},_codeListValue:function(t){return t?t._codeListValue:null}};return{template:'<ul><li><span class="iso19115-head" ng-show="display">{{display}}:</span> <span class="iso19115-value">{{value}}</span></li></ul>',restrict:"AE",replace:!0,scope:{node:"=",name:"@",type:"@"},link:function(n){n.display=e(n.name),n.value=t[n.type](n.node)}}}]).filter("iso19115NodeName",[function(){return e}])}(angular),function(t){t.module("common.legend",[]).directive("commonLegend",[function(){return{template:"<img ng-href='url' ng-if='url'></img>",scope:{map:"="},restrict:"AE",link:function(t){t.map}}}])}(angular);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();!function(t){t.module("common.metaview",[]).directive("commonMetaview",["metaviewService",function(t){return{templateUrl:"common/metaview/metaview.html",restrict:"AE",scope:{url:"=",container:"=",item:"="},link:function(e){console.log("URL = "+e.url),e.select=function(){t.get(e.url,{cache:!0}).then(function(t){e.item.metadata=t,e.container.selected=e.item})}}}}]).directive("commonItemMetaview",[function(){return{templateUrl:"common/metaview/item.html",restrict:"AE",scope:{container:"="},link:function(t){}}}]).directive("metaviewIso19115",[function(){return{templateUrl:"common/metaview/iso19115.html",restrict:"AE",scope:{data:"="},link:function(t){}}}]).directive("metaviewIso19115Array",["RecursionHelper",function(e){function n(e){e.isObject=function(){return t.isObject(e.node)},e.getKeys=function(){if(e.isObject())return Object.keys(e.node).filter(function(t){return!(excludeNodes[t]||t.indexOf(":")>-1)}).map(function(t){return""===t?'""':t})}}return{template:'<metaview-node ng-repeat="nextKey in getKeys() track by $index" node="node[nextKey]" key="nextKey"></metaview-node>',restrict:"AE",scope:{data:"="},compile:function(t){return e.compile(t,n)}}}]).directive("metaviewIso19115Node",["RecursionHelper",function(e){function n(e){e.isObject=function(){return t.isObject(e.node)},e.getKeys=function(){if(e.isObject())return Object.keys(e.node).filter(function(t){return!(a[t]||t.indexOf(":")>-1)}).map(function(t){return""===t?'""':t})},e.isArray=function(){return t.isArray(e.node)}}var a={$$hashKey:!0,__prefix:!0,__text:!0,_codeList:!0,_codeListValue:!0,CharacterString:!0,DateTime:!0,LanguageCode:!0,MD_ScopeCode:!0,scopeCode:!0};return{templateUrl:"common/metaview/iso19115node.html",restrict:"E",replace:!0,scope:{node:"=",key:"=",array:"="},compile:function(t){return e.compile(t,n)}}}]).filter("metaviewText",[function(){var e={CharacterString:"__text",DateTime:"__text",LanguageCode:"_codeListValue",linkage:["URL","__text"],MD_ScopeCode:"_codeListValue",_codeListValue:"#text"},n=[];return t.forEach(e,function(t,e){this.push(e)},n),function(t){var a=null;return t&&n.some(function(n){var o=t[n];if(o){var r=e[n];Array.isArray(r)||(r=[r]);var i=o;return r.forEach(function(t){"#text"!==t&&(i=i[t])}),a=i,!0}return!1}),a}}]).filter("metaviewNodeName",[function(){return function(t){if(parseInt(t)+""==""+t)return console.log("Its a num"),"";if(t.toUpperCase()===t)return t;var e=t.split("_"),n=e[e.length-1];return n.replace(/./,function(t){return t.toUpperCase()}).replace(/([A-Z])/g," $1").trim()}}]).filter("metaviewTransform",[function(){return function(t,e){return t.CharacterString?t.CharacterString.__text:t}}]).provider("metaviewService",function(){var t="xml2js/";this.proxy=function(e){t=e},this.$get=["$http",function(n){return new e(t,n)}]});var e=function(){function t(e,n){_classCallCheck(this,t),this.proxy=e,this.http=n}return _createClass(t,[{key:"get",value:function(t){return this.http.get(this.proxy+t).then(function(t){return t.data})}}]),t}()}(angular),function(t){function e(t){var e=this;t.data().then(function(t){e.data=t})}function n(){return{add:function(t){},remove:function(t){}}}t.module("common.panes",[]).directive("icsmPanes",["$rootScope","$timeout","mapService",function(t,e,n){return{templateUrl:"common/panes/panes.html",transclude:!0,replace:!0,scope:{defaultItem:"@",data:"="},controller:["$scope",function(a){var o=!1;a.view=a.defaultItem,a.setView=function(e){var r=a.view;a.view==e?(e&&(o=!0),a.view=""):(e||(o=!0),a.view=e),t.$broadcast("view.changed",a.view,r),o&&n.getMap().then(function(t){t._onResize()})},e(function(){t.$broadcast("view.changed",a.view,null)},50)}]}}]).directive("icsmTabs",[function(){return{templateUrl:"common/panes/tabs.html",require:"^icsmPanes"}}]).controller("PaneCtrl",e).factory("paneService",n),e.$inject=["paneService"],n.$inject=[]}(angular),function(t){t.module("common.altthemes",[]).directive("altThemes",["altthemesService",function(t){return{restrict:"AE",templateUrl:"common/navigation/altthemes.html",scope:{current:"="},link:function(e){t.getThemes().then(function(t){e.themes=t}),t.getCurrentTheme().then(function(t){e.theme=t}),e.changeTheme=function(n){e.theme=n,t.setTheme(n.key)}}}}]).controller("altthemesCtrl",["altthemesService",function(t){this.service=t}]).filter("altthemesFilter",function(){return function(t,e){var n=[];return e?(t&&t.forEach(function(t){t.themes&&t.themes.some(function(t){return t===e.key})&&n.push(t)}),n):t}}).factory("altthemesService",["$q","$http","storageService",function(e,n,a){var o="icsm.current.theme",r="icsm/resources/config/themes.json",i="All",c=[],s=this;return this.themes=[],this.theme=null,a.getItem(o).then(function(e){e||(e=i),n.get(r,{cache:!0}).then(function(n){var a=n.data.themes;s.themes=a,s.theme=a[e],t.forEach(a,function(t,e){t.key=e}),c.forEach(function(t){t.resolve(s.theme)})})}),this.getCurrentTheme=function(){if(this.theme)return e.when(s.theme);var t=e.defer();return c.push(t),t.promise},this.getThemes=function(){return n.get(r,{cache:!0}).then(function(t){return t.data.themes})},this.setTheme=function(t){this.theme=this.themes[t],a.setItem(o,t)},this}]).filter("altthemesEnabled",function(){return function(t){return t?t.filter(function(t){return!!t.enabled}):t}}).filter("altthemesMatchCurrent",function(){return function(t,e){return t?t.filter(function(t){return!!t.keys.find(function(t){return t===e})}):t}})}(angular),function(t){t.module("common.navigation",[]).directive("commonNavigation",[function(){return{restrict:"AE",template:"<alt-themes current='current'></alt-themes>",scope:{current:"=?"},link:function(t){t.username="Anonymous",t.current||(t.current="none")}}}]).factory("navigationService",[function(){return{}}])}(angular),angular.module("common.proxy",[]).provider("proxy",function(){this.$get=["$http","$q",function(t,e){var n="proxy/";return this.setProxyBase=function(t){n=t},{get:function(t,e){return this._method("get",t,e)},post:function(t,e){return this._method("post",t,e)},put:function(t,e){return this._method("put",t,e)},_method:function(e,a,o){return t[e](n+a,o).then(function(t){return t.data})}}}]}),function(t){t.module("common.recursionhelper",[]).factory("RecursionHelper",["$compile",function(e){return{compile:function(n,a){t.isFunction(a)&&(a={post:a});var o,r=n.contents().remove();return{pre:a&&a.pre?a.pre:null,post:function(t,n){o||(o=e(r)),o(t,function(t){n.append(t)}),a&&a.post&&a.post.apply(null,arguments)}}}}}])}(angular),angular.module("common.reset",[]).directive("resetPage",function(t){return{restrict:"AE",scope:{},templateUrl:"common/reset/reset.html",controller:["$scope",function(e){e.reset=function(){t.location.reload()}}]}}),function(t){t.module("common.scroll",[]).directive("commonScroller",["$timeout",function(t){return{scope:{more:"&",buffer:"=?"},link:function(e,n,a){var o;e.buffer||(e.buffer=100),n.on("scroll",function(n){function a(){e.more&&r.scrollHeight-r.scrollTop<=r.clientHeight+e.buffer&&e.more()}var r=n.currentTarget;t.cancel(o),o=t(a,120)})}}}])}(angular),function(t){function e(){var t="icsm/resources/config/basins.json",e="service/basinsearch/basin/",n="",a={};this.setReferenceUrl=function(e){t=e},this.setShapeUrl=function(t){e=t},this.setBaseUrl=function(t){n=t},this.$get=["$q","$rootScope","$timeout","httpData","searchMapService",function(o,r,i,c,s){var l={load:function(){return c.get(n+t,{cache:!0}).then(function(t){return a.basins=t.data.basins,a})},zoomToLocation:function(t){function a(){s.goTo(i)}var o=t.bbox,i={type:"Polygon",coordinates:[[[o.xMin,o.yMin],[o.xMin,o.yMax],[o.xMax,o.yMax],[o.xMax,o.yMin],[o.xMin,o.yMin]]]
},c={from:"Basins search",type:"GeoJSONUrl",url:n+e+t.id,pan:a,show:!0,name:t.name,polygon:i};r.$broadcast("search.performed",c),a()}};return l}]}t.module("common.basin",["geo.draw"]).directive("commonBasinSearch",["$log","$timeout","basinService",function(t,e,n){return{restrict:"AE",transclude:!0,templateUrl:"common/search/basin.html",link:function(a,o){function r(){e.cancel(i),i=e(function(){t.info("Clear filter"),a.nameFilter=""},7e3)}var i;n.load().then(function(t){a.basinData=t}),a.changing=function(){t.info("Cancel close"),e.cancel(i)},a.cancel=r,a.zoomToLocation=function(t){n.zoomToLocation(t),r()}}}}]).provider("basinService",e).filter("basinFilterList",function(){return function(t,e,n){var a,o,r=[];return e?(n||(n=50),a=e.toLowerCase(),t&&(o=0,t.some(function(t){return t.name.toLowerCase().indexOf(a)>-1&&(r.push(t),o++),o>n})),r):r}})}(angular),function(t){function e(){var t="icsm/resources/config/catchments.json",e="service/catchmentsearch/catchment/",n="",a={};this.setReferenceUrl=function(e){t=e},this.setShapeUrl=function(t){e=t},this.setBaseUrl=function(t){n=t},this.$get=["$q","$rootScope","$timeout","httpData","searchMapService",function(o,r,i,c,s){var l={load:function(){return c.get(n+t,{cache:!0}).then(function(t){return a.catchments=t.data.catchments,a})},zoomToLocation:function(t){function a(){s.goTo(i)}var o=t.bbox,i={type:"Polygon",coordinates:[[[o.xMin,o.yMin],[o.xMin,o.yMax],[o.xMax,o.yMax],[o.xMax,o.yMin],[o.xMin,o.yMin]]]},c={from:"Catchments search",type:"GeoJSONUrl",url:n+e+t.id,pan:a,show:!0,name:t.name,polygon:i};r.$broadcast("search.performed",c),a()}};return l}]}t.module("common.catchment",["geo.draw"]).directive("commonCatchmentSearch",["$log","$timeout","catchmentService",function(t,e,n){return{restrict:"AE",transclude:!0,templateUrl:"common/search/catchment.html",link:function(a,o){function r(){e.cancel(i),i=e(function(){t.info("Clear filter"),a.nameFilter=""},7e3)}var i;n.load().then(function(t){a.catchmentData=t}),a.changing=function(){t.info("Cancel close"),e.cancel(i)},a.cancel=r,a.zoomToLocation=function(t){n.zoomToLocation(t),r()}}}}]).provider("catchmentService",e).filter("catchmentFilterList",function(){return function(t,e,n){var a,o,r=[];return e?(n||(n=50),a=e.toLowerCase(),t&&(o=0,t.some(function(t){return t.name.toLowerCase().indexOf(a)>-1&&(r.push(t),o++),o>n})),r):r}})}(angular),angular.module("icsm.side-panel",[]).factory("panelSideFactory",["$rootScope","$timeout",function(t,e){function n(t,e){var n=t.active;return n===e?(t.active=null,t.width=0):t.active=e,!n}var a={left:{active:null,width:0},right:{active:null,width:0}};return{state:a,setLeft:function(t){var e=n(a.left,t);return e&&(a.left.width=320),e},setRight:function(e){a.right.width=e.width;var o=n(a.right,e.name);return t.$broadcast("side.panel.change",{side:"right",data:a.right,width:e.width}),o}}}]).directive("sidePanelRightOppose",["panelSideFactory",function(t){return{restrict:"E",transclude:!0,template:'<div class="contentContainer" ng-attr-style="right:{{right.width}}"><ng-transclude></ng-transclude></div>',link:function(e){e.right=t.state.right}}}]).directive("sidePanelRight",["panelSideFactory",function(t){return{restrict:"E",transclude:!0,templateUrl:"icsm/side-panel/side-panel-right.html",link:function(e){e.right=t.state.right,e.closePanel=function(){t.setRight({name:null,width:0})}}}}]).directive("panelTrigger",["panelSideFactory",function(t){return{restrict:"E",transclude:!0,templateUrl:"common/side-panel/trigger.html",scope:{"default":"@?",panelWidth:"@",name:"@",iconClass:"@",panelId:"@"},link:function(e){e.toggle=function(){t.setRight({width:e.panelWidth,name:e.panelId})},e["default"]&&t.setRight({width:e.panelWidth,name:e.panelId})}}}]).directive("panelOpenOnEvent",["$rootScope","panelSideFactory",function(t,e){return{restrict:"E",scope:{panelWidth:"@",eventName:"@",panelId:"@",side:"@?"},link:function(n){n.side||(n.side="right"),t.$on(n.eventName,function(t,a){var o=e.state[n.side];if(o&&(!o.active||n.panelId!==o.active)){var r={width:n.panelWidth,name:n.panelId};"right"===n.side?e.setRight(r):e.setLeft(r)}})}}}]).directive("panelCloseOnEvent",["$rootScope","panelSideFactory",function(t,e){return{restrict:"E",scope:{eventName:"@",side:"@?",onlyOn:"@?"},link:function(n){n.side||(n.side="right"),t.$on(n.eventName,function(t,a){var o=e.state[n.side];if((!n.onlyOn||o.active===n.onlyOn)&&o&&o.active){var r={name:null};"right"===n.side?e.setRight(r):e.setLeft(r)}})}}}]).directive("sidePanelLeft",["panelSideFactory",function(t){return{restrict:"E",transclude:!0,templateUrl:"icsm/side-panel/side-panel-left.html",link:function(e){e.left=t.state.left,e.closeLeft=function(){t.setLeft(null)}}}}]),function(t){t.module("ui.bootstrap-slider",[]).directive("slider",["$parse","$timeout",function(e,n){return{restrict:"AE",replace:!0,template:'<div><input class="slider-input" type="text" /></div>',require:"ngModel",scope:{max:"=",min:"=",step:"=",value:"=",ngModel:"=",range:"=",enabled:"=",sliderid:"=",formatter:"&",onStartSlide:"&",onStopSlide:"&",onSlide:"&"},link:function(a,o,r,i,c){function s(){function c(t,e,n){p[t]=e||n}function s(t,e,n){p[t]=e?parseFloat(e):n}function u(t,e,n){p[t]=e?e+""=="true":n}function m(e){return t.isString(e)&&0===e.indexOf("[")?t.fromJson(e):e}var p={};c("id",a.sliderid),c("orientation",r.orientation,"horizontal"),c("selection",r.selection,"before"),c("handle",r.handle,"round"),c("tooltip",r.uiTooltip,"show"),c("tooltipseparator",r.tooltipseparator,":"),s("min",a.min,0),s("max",a.max,10),s("step",a.step,1);var h=p.step+"",f=h.substring(h.lastIndexOf(".")+1);if(s("precision",r.precision,f),u("tooltip_split",r.tooltipsplit,!1),u("enabled",r.enabled,!0),u("naturalarrowkeys",r.naturalarrowkeys,!1),u("reversed",r.reversed,!1),u("range",a.range,!1),p.range){if(t.isArray(a.value))p.value=a.value;else if(t.isString(a.value)){if(p.value=m(a.value),!t.isArray(p.value)){var g=parseFloat(a.value);isNaN(g)&&(g=5),g<a.min?(g=a.min,p.value=[g,p.max]):g>a.max?(g=a.max,p.value=[p.min,g]):p.value=[p.min,p.max]}}else p.value=[p.min,p.max];a.ngModel=p.value}else s("value",a.value,5);a.formatter&&(p.formatter=a.$eval(a.formatter));var v=$(o).find(".slider-input").eq(0);if($.fn.slider){$.fn.slider.constructor.prototype.disable=function(){this.picker.off()},$.fn.slider.constructor.prototype.enable=function(){this.picker.on()},v.slider(p),v.slider("destroy"),v.slider(p);var y=m(r.updateevent);y=t.isString(y)?[y]:["slide"],t.forEach(y,function(t){v.on(t,function(t){i.$setViewValue(t.value),n(function(){a.$apply()})})}),v.on("change",function(t){i.$setViewValue(t.value.newValue),n(function(){a.$apply()})});var b={slideStart:"onStartSlide",slide:"onSlide",slideStop:"onStopSlide"};t.forEach(b,function(t,o){v.on(o,function(o){if(a[t]){var i=e(r[t]);i(a.$parent,{$event:o,value:o.value}),n(function(){a.$apply()})}})}),t.isFunction(d)&&(d(),d=null),t.isDefined(r.ngDisabled)&&(d=a.$watch(r.ngDisabled,function(t){t?v.slider("disable"):v.slider("enable")})),t.isFunction(l)&&l(),l=a.$watch("ngModel",function(t){v.slider("setValue",t)})}window.slip=v,a.$watch("enabled",function(t){t?v.slider("disable"):v.slider("enable")})}var l,d;s();var u=["min","max","step","range"];t.forEach(u,function(t){a.$watch(t,function(){s()})})}}}])}(angular),function(t){t.module("common.storage",["explorer.projects"]).factory("storageService",["$log","$q","projectsService",function(t,e,n){return{setGlobalItem:function(t,e){this._setItem("_system",t,e)},setItem:function(t,e){n.getCurrentProject().then(function(n){this._setItem(n,t,e)}.bind(this))},_setItem:function(e,n,a){t.debug("Fetching state for key locally"+n),localStorage.setItem("mars.anon."+e+"."+n,JSON.stringify(a))},getGlobalItem:function(t){return this._getItem("_system",t)},getItem:function(t){var a=e.defer();return n.getCurrentProject().then(function(e){this._getItem(e,t).then(function(t){a.resolve(t)})}.bind(this)),a.promise},_getItem:function(n,a){t.debug("Fetching state locally for key "+a);var o=localStorage.getItem("mars.anon."+n+"."+a);if(o)try{o=JSON.parse(o)}catch(r){}return e.when(o)}}}])}(angular),function(t){t.module("common.tile",[]).directive("commonTile",["$rootScope","tileService",function(t,e){return{scope:{data:"="},template:'<button type="button" class="undecorated" ng-if="data.tileCache" ng-click="toggle(item)" title="Show/hide Tile layer." tooltip-placement="right" tooltip="View on mapS."><i ng-class="{active:data.isTilesShowing}" class="fa fa-lg fa-globe"></i></button>',link:function(n){n.$watch("data",function(t,n){t?e.subscribe(t):n&&e.unsubscribe(n)}),n.toggle=function(){n.data.isTilesShowing?e.hide(n.data):e.show(n.data)},t.$on("hide.wms",function(t,e){n.data&&e==n.data.primaryId&&n.data.isTilesShowing&&n.toggle()}),n.$on("$destroy",function(){e.unsubscribe(n.data)})}}}]).factory("tileService",["$http","$log","$q","$timeout","selectService","mapService",function(t,e,n,a,o,r){function i(t){this.service=t,this.tileLayer=null,this.capabilities=null,this.toggleTile=function(){this.tileLayer?this.clearTile():this.showTile()},this.showTile=function(){var e=function(){t.tileCacheOptions&&"WMS"===t.tileCacheOptions.type?this.tileLayer=L.tileLayer.wms(t.tileCache,t.tileCacheOptions):this.tileLayer=L.tileLayer(t.tileCache,t.tileCacheOptions),this.tileLayer.addTo(o.getLayerGroup())};return this.tileLayer&&this.clearTile(),n.when(e.apply(this))},this.clearTile=function(){return this.tileLayer&&(o.getLayerGroup().removeLayer(this.tileLayer),this.tileLayer=null),null}}var c={};return{createLayer:function(t){return new i(t)},subscribe:function(t){var e=t.primaryId,n=c[e];t&&t.tileCache&&(n?n.count+=1:n=c[e]={count:1,layer:this.createLayer(t)},1===n.count&&t.isTilesShowing&&this._showLayer(n.layer))},unsubscribe:function(t){var e=t.primaryId,n=c[e];n&&(n.count--,n.count||t.isTilesShowing&&this._hideLayer(n.layer))},_showLayer:function(t){t&&t.showTile()},_hideLayer:function(t){t&&t.clearTile()},show:function(t){t.isTilesShowing=!0,this._showLayer(c[t.primaryId].layer)},hide:function(t){t.isTilesShowing=!1,this._hideLayer(c[t.primaryId].layer)}}}])}(angular),function(t){t.module("common.toolbar",[]).directive("icsmToolbar",[function(){return{controller:"toolbarLinksCtrl"}}]).directive("icsmToolbarRow",[function(){var t="Satellite to Topography bias on base map.";return{scope:{map:"=",overlaytitle:"=?"},restrict:"AE",templateUrl:"common/toolbar/toolbar.html",link:function(e){e.overlaytitle=e.overlaytitle?e.overlaytitle:t}}}]).controller("toolbarLinksCtrl",["$scope","configService",function(t,e){var n=this;e.getConfig().then(function(t){n.links=t.toolbarLinks}),t.item="",t.toggleItem=function(e){t.item=t.item==e?"":e}}])}(angular),function(t){t.module("common.wms",[]).directive("commonWms",["$rootScope","$timeout","flashService","wmsService",function(t,e,n,a){return{scope:{data:"="},template:'<button type="button" class="undecorated" ng-show="data.services.hasWms()" ng-click="toggle(item)" title="Show/hide WMS layer." tooltip-placement="right" tooltip="View on map using WMS."><i ng-class="{active:data.isWmsShowing}" class="fa fa-lg fa-globe"></i></button>',link:function(e){e.$watch("data",function(t,e){t?a.subscribe(t):e&&a.unsubscribe(e)}),t.$on("hide.wms",function(t,n){e.data&&n===e.data.sysId&&e.data.isWmsShowing&&e.toggle()}),e.toggle=function(){e.data.isWmsShowing?a.hide(e.data):a.show(e.data)},e.$on("$destroy",function(){a.unsubscribe(e.data)})}}}]).factory("wmsService",["$http","$log","$q","$timeout","selectService","mapService",function(t,e,n,a,o,r){function i(e){var a,r="service/metadata/wmsLayernames";a=e.url.indexOf("?")>-1?e.url.substr(0,e.url.indexOf("?")):e.url,this.service=e,this.layerGroup=o.getLayerGroup(),this.wmsLayer=null,this.capabilities=null,this.toggleWms=function(){this.wmsLayer?this.clearWms():this.showWms()},this.showWms=function(){var o=function(){this.wmsLayer=L.tileLayer.wms(a,{layers:this.layerNames,format:"image/png",transparent:!0}).addTo(this.layerGroup)};if(this.wmsLayer&&this.clearWms(),!this.layerNames){if(!e.layerNames)return t.get(r,{params:{url:a},cache:!0}).then(function(t){this.layerNames=t.data,o.apply(this)}.bind(this));this.layerNames=e.layerNames}return n.when(o.apply(this))},this.clearWms=function(){return this.wmsLayer&&(this.layerGroup.removeLayer(this.wmsLayer),this.wmsLayer=null),null}}var c=(new X2JS,{});return{createLayer:function(t){return new i(t)},subscribe:function(t){if(t.services&&t.services.getWms){var e=t.primaryId,n=t.services.getWms(),a=c[e];n&&(a?a.count+=1:a=c[e]={count:1,layer:this.createLayer(n)},1===a.count&&t.isWmsShowing&&this._showLayer(a.layer))}},unsubscribe:function(t){var e=t.primaryId,n=c[e];n&&(n.count--,n.count||t.isWmsShowing&&this._hideLayer(n.layer))},_showLayer:function(t){t&&t.showWms()},_hideLayer:function(t){t&&t.clearWms()},show:function(t){t.isWmsShowing=!0,this._showLayer(c[t.primaryId].layer)},hide:function(t){t.isWmsShowing=!1,this._hideLayer(c[t.primaryId].layer)}}}])}(angular),angular.module("common.templates",[]).run(["$templateCache",function(t){t.put("common/accordion/accordion.html",'<div role="tablist" class="panel-group" ng-transclude></div>'),t.put("common/accordion/accordionGroup.html",'<div role="tab" id="{{::headingId}}" aria-selected="{{isOpen}}" class="panel-heading" ng-keypress="toggleOpen($event)">\r\n  <h4 class="panel-title">\r\n    <a role="button" data-toggle="collapse" href aria-expanded="{{isOpen}}"\r\n            aria-controls="{{::panelId}}" tabindex="0" class="accordion-toggle" ng-click="toggleOpen()"\r\n            common-accordion-transclude="heading" ng-disabled="isDisabled" uib-tabindex-toggle>\r\n      <span common-accordion-header ng-class="{\'text-muted\': isDisabled}">{{heading}}</span>\r\n   </a>\r\n  </h4>\r\n</div>\r\n<div id="{{::panelId}}" aria-labelledby="{{::headingId}}" aria-hidden="{{!isOpen}}" role="tabpanel"\r\n            class="panel-collapse collapse" uib-collapse="!isOpen">\r\n  <div class="panel-body" ng-transclude></div>\r\n</div>'),t.put("common/bbox/bbox.html",'<button type="button" class="undecorated" ng-click="toggle()" tooltip-placement="right" title="Show data extent on the map.">\r\n\t<i class="fa pad-right fa-lg" ng-class="{\'fa-eye orange\':data.hasBbox,\'fa-eye-slash\':!data.hasBbox}"></i>\r\n</button>'),t.put("common/cc/cc.html",'<button type="button" class="undecorated" title="View CCBy {{details.version}} licence details"\r\n      popover-trigger="outsideClick"\r\n      uib-popover-template="template" popover-placement="bottom" popover-append-to-body="true">\r\n\t<i ng-class="{active:data.isWmsShowing}" class="fa fa-lg fa-gavel"></i>\r\n</button>'),t.put("common/cc/cctemplate.html",'<div>\r\n   <div class="row">\r\n      <div class="col-md-12">\r\n         <a target="_blank" ng-href="{{details.link}}">Creative Commons Attribution {{details.version}} </a>\r\n      </div>\r\n   </div>\r\n   <div class="row">\r\n      <div class="col-md-2">\r\n         <span class="fa-stack" aria-hidden="true">\r\n         <i class="fa fa-check-circle-o fa-stack-2x" aria-hidden="true"></i>\r\n      </span>\r\n      </div>\r\n      <div class="col-md-10">\r\n         You may use this work for commercial purposes.\r\n      </div>\r\n   </div>\r\n   <div class="row">\r\n      <div class="col-md-2">\r\n         <span class="fa-stack" aria-hidden="true">\r\n         <i class="fa fa-circle-o fa-stack-2x"></i>\r\n         <i class="fa fa-female fa-stack-1x"></i>\r\n      </span>\r\n      </div>\r\n      <div class="col-md-10">\r\n         You must attribute the creator in your own works.\r\n      </div>\r\n   </div>\r\n</div>'),t.put("common/download/download.html",'<exp-modal ng-controller="DownloadCtrl as dl" icon-class="fa-download" is-open="dl.data.item.download" title="Download data" on-close="dl.remove()" is-modal="true">\r\n\t<div style="padding:5px;">\r\n\t\t<div class="row">\r\n  \t\t\t<div class="col-md-12">\r\n\t\t\t\t<h4><common-wms data="dl.data.item"></common-wms><common-tile data="dl.data.item"></common-tile>{{dl.data.item.title}}</h4>\r\n\t\t\t\t{{dl.data.item.abstract}}\r\n   \t\t\t</div>\r\n\t\t</div>\r\n\t\t<nedf-geoprocess data="dl.data.item"></nedf-geoprocess>\r\n\t</div>\r\n</exp-modal>'),t.put("common/download/popup.html",'<exp-modal icon-class="fa-download"  is-open="data.item.download" title="Download wizard" on-close="dl.remove()">\r\n\t<div class="container-fluid downloadInner" >\r\n\t\t<div class="row">\r\n  \t\t\t<div class="col-md-12">\r\n\t\t\t\t<h4><common-wms data="dl.data.item"></common-wms>\r\n\t\t\t\t\t<a href="https://ecat.ga.gov.au/geonetwork/srv/eng/search#!{{dl.data.item.primaryId}}" target="_blank"><strong class="ng-binding">{{dl.data.item.title}}</strong></a>\r\n\t\t\t\t</h4>\r\n   \t\t\t</div>\r\n\t\t</div>\r\n\t\t<wizard-geoprocess data="dl.data.item"></wizard-geoprocess>\r\n\t</div>\r\n</exp-modal>'),t.put("common/clip/clip.html",'<div class="well well-sm">\r\n<div class="container-fluid">\r\n\t<div class="row">\r\n\t\t<div class="col-md-12">\r\n\t\t\t<button style="margin-top:0px;" ng-click="initiateDraw()" ng-disable="client.drawing" class="btn btn-primary btn-xs">Draw</button>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="row">\r\n\t\t<div class="col-md-3"> </div>\r\n\t\t<div class="col-md-8">\r\n\t\t\t<strong>Y Max:</strong>\r\n\t\t\t<span><input type="text" style="width:6em" ng-model="clip.yMax"></input><span ng-show="showBounds && bounds">({{bounds.yMax|number : 4}} max)</span></span>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="row">\r\n\t\t<div class="col-md-6">\r\n\t\t\t<strong>X Min:</strong>\r\n\t\t\t<span><input type="text" style="width:6em" ng-model="clip.xMin"></input><span ng-show="showBounds && bounds">({{bounds.xMin|number : 4}} min)</span></span>\r\n\t\t</div>\r\n\t\t<div class="col-md-6">\r\n\t\t\t<strong>X Max:</strong>\r\n\t\t\t<span><input type="text" style="width:6em" ng-model="clip.xMax"></input><span ng-show="showBounds && bounds">({{bounds.xMax|number : 4}} max)</span></span>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="row">\r\n\t\t<div class="col-md-offset-3 col-md-8">\r\n\t\t\t<strong>Y Min:</strong>\r\n\t\t\t<span><input type="text" style="width:6em" ng-model="clip.yMin"></input><span ng-show="showBounds && bounds">({{bounds.yMin|number : 4}} min)</span></span>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n</div>'),t.put("common/extent/extent.html",'<div class="row" style="border-top: 1px solid gray; padding-top:5px">\r\n\t<div class="col-md-5">\r\n\t\t<div class="form-inline">\r\n\t\t\t<label>\r\n\t\t\t\t<input id="extentEnable" type="checkbox" ng-model="parameters.fromMap" ng-click="change()"></input> \r\n\t\t\t\tRestrict area to map\r\n\t\t\t</label>\r\n\t\t</div>\r\n\t</div>\r\n\t \r\n\t<div class="col-md-7" ng-show="parameters.fromMap">\r\n\t\t<div class="container-fluid">\r\n\t\t\t<div class="row">\r\n\t\t\t\t<div class="col-md-offset-3 col-md-8">\r\n\t\t\t\t\t<strong>Y Max:</strong> \r\n\t\t\t\t\t<span>{{parameters.yMax | number : 4}}</span> \r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class="row">\r\n\t\t\t\t<div class="col-md-6">\r\n\t\t\t\t\t<strong>X Min:</strong>\r\n\t\t\t\t\t<span>{{parameters.xMin | number : 4}}</span> \r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="col-md-6">\r\n\t\t\t\t\t<strong>X Max:</strong>\r\n\t\t\t\t\t<span>{{parameters.xMax | number : 4}}</span> \r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class="row">\r\n\t\t\t\t<div class="col-md-offset-3 col-md-8">\r\n\t\t\t\t\t<strong>Y Min:</strong>\r\n\t\t\t\t\t<span>{{parameters.yMin | number : 4}}</span> \r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("common/geoprocess/geoprocess.html",'<div class="container-fluid" style="overflow-x:hidden" ng-form>\r\n\t<div ng-show="stage==\'bbox\'">\r\n\t\t<div class="row">\r\n\t\t\t<div class="col-md-12">\r\n\t\t\t\t<wizard-clip trigger="stage == \'bbox\'" drawn="drawn()" clip="data.processing.clip" bounds="data.bounds"></wizard-clip>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="row" style="height:55px">\r\n \t\t\t<div class="col-md-12">\r\n\t\t\t\t<button class="btn btn-primary pull-right" ng-disabled="!validClip(data) || checkingOrFailed" ng-click="stage=\'formats\'">Next</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="well">\r\n\t\t\t<strong style="font-size:120%">Select an area of interest.</strong> There are two ways to select your area of interest:\r\n\t\t\t<ol>\r\n\t\t\t\t<li>Draw an area on the map with the mouse by clicking a corner and while holding the left mouse button\r\n\t\t\t\t\tdown drag diagonally across the map to the opposite corner or</li>\r\n\t\t\t\t<li>Type your co-ordinates into the areas above.</li>\r\n\t\t\t</ol>\r\n\t\t\tOnce drawn the points can be modified by the overwriting the values above or drawing another area by clicking the draw button again.\r\n\t\t\tEnsure you select from the highlighted areas as the data can be quite sparse for some data.<br/>\r\n\t\t\t<p style="padding-top:5px">\r\n\t\t\t<strong>Warning:</strong> Some extracts can be huge. It is best if you start with a small area to experiment with first. An email will be sent\r\n\t\t\twith the size of the extract. Download judiciously.\r\n\t\t\t</p>\r\n\t\t\t<p style="padding-top"><strong>Hint:</strong> If the map has focus, you can use the arrow keys to pan the map.\r\n\t\t\t\tYou can zoom in and out using the mouse wheel or the "+" and "-" map control on the top left of the map. If you\r\n\t\t\t\tdon\'t like the position of your drawn area, hit the "Draw" button and draw a new bounding box.\r\n\t\t\t</p>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div ng-show="stage==\'formats\'">\r\n\t\t<div class="well">\r\n\t\t<div class="row">\r\n  \t\t\t<div class="col-md-3">\r\n\t\t\t\t<label for="geoprocessOutputFormat">\r\n\t\t\t\t\tOutput Format\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-md-9">\r\n\t\t\t\t<select id="geoprocessOutputFormat" style="width:95%" ng-model="data.processing.outFormat" ng-options="opt.value for opt in config.outFormat"></select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="row">\r\n\t\t\t<div class="col-md-3">\r\n\t\t\t\t<label for="geoprocessOutCoordSys">\r\n\t\t\t\t\tCoordinate System\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-md-9">\r\n\t\t\t\t<select id="geoprocessOutCoordSys" style="width:95%" ng-model="data.processing.outCoordSys" ng-options="opt.value for opt in config.outCoordSys | sysIntersect : data.processing.clip"></select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="row" style="height:55px">\r\n\t\t\t<div class="col-md-6">\r\n\t\t\t\t<button class="btn btn-primary" ng-click="stage=\'bbox\'">Previous</button>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-md-6">\r\n\t\t\t\t<button class="btn btn-primary pull-right" ng-disabled="!validSansEmail(data)" ng-click="stage=\'email\'">Next</button>\r\n   \t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="well">\r\n\t\t\t<strong style="font-size:120%">Data representation.</strong> Select how you want your data presented.<br/>\r\n\t\t\tOutput format is the structure of the data and you should choose a format compatible with the tools that you will use to manipulate the data.\r\n\t\t\t<ul>\r\n\t\t\t\t<li ng-repeat="format in outFormats"><strong>{{format.value}}</strong> - {{format.description}}</li>\r\n\t\t\t</ul>\r\n\t\t\tSelect what <i>coordinate system</i> or projection you would like. If in doubt select WGS84.<br/>\r\n\t\t\tNot all projections cover all of Australia. If the area you select is not covered by a particular projection then the option to download in that projection will not be available.\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div ng-show="stage==\'email\'">\r\n\t\t<div class="well" exp-enter="stage=\'confirm\'">\r\n\t\t\t<div download-email></div>\r\n\t\t\t<br/>\r\n\t\t\t<div download-filename data="data.processing"></div>\r\n\t\t</div>\r\n\t\t<div class="row" style="height:55px">\r\n\t\t\t<div class="col-md-6">\r\n\t\t\t\t<button class="btn btn-primary" ng-click="stage=\'formats\'">Previous</button>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-md-6">\r\n\t\t\t\t<button class="btn btn-primary pull-right" ng-disabled="!allDataSet(data)" ng-click="stage=\'confirm\'">Submit</button>\r\n   \t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="well">\r\n\t\t\t<strong style="font-size:120%">Email notification</strong> The extract of data can take some time. By providing an email address we will be able to notify you when the job is complete. The email will provide a link to the extracted\r\n\t\t\tdata which will be packaged up as a single file. To be able to proceed you need to have provided:\r\n\t\t\t<ul>\r\n\t\t\t\t<li>An area of interest to extract the data (referred to as a bounding box).</li>\r\n\t\t\t\t<li>An output format.</li>\r\n\t\t\t\t<li>A valid coordinate system or projection.</li>\r\n\t\t\t\t<li>An email address to receive the details of the extraction.</li>\r\n\t\t\t\t<li><strong>Note:</strong>Email addresses need to be and are stored in the system.</li>\r\n\t\t\t</ul>\r\n\t\t\t<strong style="font-size:120%">Optional filename</strong> The extract of data can take some time. By providing an optional filename it will allow you\r\n\t\t\tto associate extracted data to your purpose for downloading data. For example:\r\n\t\t\t<ul>\r\n\t\t\t\t<li>myHouse will have a file named myHouse.zip</li>\r\n\t\t\t\t<li>Sorrento would result in a file named Sorrento.zip</li>\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div ng-show="stage==\'confirm\'">\r\n\t\t<div class="row">\r\n\t\t\t<div class="col-md-12 abstractContainer">\r\n\t\t\t\t{{data.abstract}}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<h3>You have chosen:</h3>\r\n\t\t<table class="table table-striped">\r\n\t\t\t<tbody>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<th>Area</th>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<span style="display:inline-block; width: 10em">Lower left (lat/lng&deg;):</span> {{data.processing.clip.yMin | number : 6}}, {{data.processing.clip.xMin | number : 6}}<br/>\r\n\t\t\t\t\t\t<span style="display:inline-block;width: 10em">Upper right (lat/lng&deg;):</span> {{data.processing.clip.yMax | number : 6}}, {{data.processing.clip.xMax | number : 6}}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<th>Output format</th>\r\n\t\t\t\t\t<td>{{data.processing.outFormat.value}}</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<th>Coordinate system</th>\r\n\t\t\t\t\t<td>{{data.processing.outCoordSys.value}}</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<th>Email address</th>\r\n\t\t\t\t\t<td>{{email}}</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr ng-show="data.processing.filename">\r\n\t\t\t\t\t<th>Filename</th>\r\n\t\t\t\t\t<td>{{data.processing.filename}}</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>\r\n\t\t</table>\r\n\t\t<div class="row" style="height:55px">\r\n\t\t\t<div class="col-md-6">\r\n\t\t\t\t<button class="btn btn-primary" style="width:6em" ng-click="stage=\'email\'">Back</button>\r\n\t\t\t</div>\r\n\t\t\t<div class="col-md-6">\r\n\t\t\t\t<button class="btn btn-primary pull-right" ng-click="startExtract()">Confirm</button>\r\n   \t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("common/header/header.html",'<div class="container-full common-header" style="padding-right:10px; padding-left:10px">\r\n    <div class="navbar-header">\r\n\r\n        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".ga-header-collapse">\r\n            <span class="sr-only">Toggle navigation</span>\r\n            <span class="icon-bar"></span>\r\n            <span class="icon-bar"></span>\r\n            <span class="icon-bar"></span>\r\n        </button>\r\n\r\n        <a href="/" class="appTitle visible-xs">\r\n            <h1 style="font-size:120%">{{heading}}</h1>\r\n        </a>\r\n    </div>\r\n    <div class="navbar-collapse collapse ga-header-collapse">\r\n        <ul class="nav navbar-nav">\r\n            <li class="hidden-xs"><a href="/"><h1 class="applicationTitle">{{heading}}</h1></a></li>\r\n        </ul>\r\n        <ul class="nav navbar-nav navbar-right nav-icons">\r\n        \t<li common-navigation role="menuitem" current="current" style="padding-right:10px"></li>\r\n\t\t\t<li mars-version-display role="menuitem"></li>\r\n\t\t\t<li style="width:10px"></li>\r\n        </ul>\r\n    </div><!--/.nav-collapse -->\r\n</div>\r\n\r\n<!-- Strap -->\r\n<div class="row">\r\n    <div class="col-md-12">\r\n        <div class="strap-blue">\r\n        </div>\r\n        <div class="strap-white">\r\n        </div>\r\n        <div class="strap-red">\r\n        </div>\r\n    </div>\r\n</div>'),t.put("common/iso19115/contact.html",'<ul ng-show="node.hierarchyLevel">\r\n   <li>\r\n      <span class="iso19115-head">Contact</span>\r\n      <iso19115-node name="MD_ScopeCode" node="node.hierarchyLevel.MD_ScopeCode" type="_codeListValue"></iso19115-node>\r\n    </li>\r\n</ul>'),t.put("common/iso19115/double.html",'\r\n<ul ng-show="node">\r\n   <li>\r\n      <span class="iso19115-head">{{name | iso19115NodeName}}</span>\r\n      <iso19115-node name="name" node="node[name]" type="type"></iso19115-node>\r\n   </li>\r\n</ul>\r\n'),t.put("common/iso19115/metadata.html",'<div class="iso19115">\r\n   <ul>\r\n      <li>\r\n         <span class="iso19115-head">Metadata</span>\r\n         <iso19115-node name="fileIdentifier" node="node.fileIdentifier" type="CharacterString"></iso19115-node>\r\n         <iso19115-node name="language" node="node.language" type="LanguageCode"></iso19115-node>\r\n         <ul ng-show="node.characterSet">\r\n            <li>\r\n               <span class="iso19115-head">Character Set</span>\r\n               <iso19115-node name="CharacterSetCode" node="node.characterSet.MD_CharacterSetCode" type="_codeListValue"></iso19115-node>\r\n            </li>\r\n         </ul>\r\n\r\n         <ul ng-show="node.hierarchyLevel">\r\n            <li>\r\n               <span class="iso19115-head">Hierarchy Level</span>\r\n               <iso19115-node name="MD_ScopeCode" node="node.hierarchyLevel.MD_ScopeCode" type="_codeListValue"></iso19115-node>\r\n            </li>\r\n         </ul>\r\n         <iso19115-node name="hierarchyLevelName" node="node.hierarchyLevelName" type="CharacterString"></iso19115-node>\r\n         <iso19115-contact ng-if="node.contact" node="node.contact" key="\'contact\'"></iso19115-contact>\r\n      </li>\r\n   </ul>\r\n</div>'),t.put("common/metaview/dublincore.html","Dublin core"),t.put("common/metaview/iso19115.html",'<iso19115-metadata node="data.metadata.GetRecordByIdResponse.MD_Metadata" key="\'MD_Metadata\'"></iso19115-metadata>\r\n'),t.put("common/metaview/iso19115node.html",'<ul>\r\n   <li>\r\n      <span class="metaview-head">{{key | metaviewNodeName}}</span>\r\n      <span>{{node | metaviewText}}</span>\r\n      <ng-repeat ng-if="isArray()" ng-repeat="next in node" node="next]">\r\n         <metaview-iso19115-array ng-repeat="nextKey in getKeys() track by $index" node="node[nextKey]" key="nextKey"></metaview-iso19115-array>\r\n      </ng-repeat>\r\n      <metaview-iso19115-node ng-if="!isArray()" ng-repeat="nextKey in getKeys() track by $index" node="node[nextKey]" key="nextKey"></metaview-iso19115-node>\r\n   </li>\r\n</ul>'),t.put("common/metaview/item.html",'<div>\r\n\t<button class="btn btn-sm btn-outline-primary" ng-click="container.selected = null"><i class="fa fa-angle-double-left"></i> Back</button>\r\n      <span style="font-weight: bold;padding-left:10px; font-size:130%">{{container.selected.title}}</span>\r\n      <metaview-iso19115 data="container.selected"></metaview-iso19115>\r\n</div>'),t.put("common/metaview/metaview.html",'<button type="button" class="undecorated" title="View metadata" ng-click="select()">\r\n\t<i class="fa fa-lg fa-info metaview-info"></i>\r\n</button>'),t.put("common/panes/panes.html",'<div class="container contentContainer">\r\n\t<div class="row icsmPanesRow" >\r\n\t\t<div class="icsmPanesCol" ng-class="{\'col-md-12\':!view, \'col-md-7\':view}" style="padding-right:0">\r\n\t\t\t<div class="panesMapContainer" geo-map configuration="data.map">\r\n\t\t\t    <geo-extent></geo-extent>\r\n\t\t\t</div>\r\n    \t\t<div geo-draw data="data.map.drawOptions" line-event="elevation.plot.data" rectangle-event="bounds.drawn"></div>\r\n\t\t</div>\r\n\t\t<div class="icsmPanesColRight" ng-class="{\'hidden\':!view, \'col-md-5\':view}" style="padding-left:0; padding-right:0">\r\n\t\t\t<div class="panesTabContentItem" ng-show="view == \'download\'" icsm-view></div>\r\n\t\t\t<div class="panesTabContentItem" ng-show="view == \'maps\'" icsm-maps></div>\r\n\t\t\t<div class="panesTabContentItem" ng-show="view == \'glossary\'" icsm-glossary></div>\r\n\t\t\t<div class="panesTabContentItem" ng-show="view == \'help\'" icsm-help></div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),
t.put("common/panes/tabs.html",'<!-- tabs go here -->\r\n<div id="panesTabsContainer" class="paneRotateTabs" style="opacity:0.9" ng-style="{\'right\' : contentLeft +\'px\'}">\r\n\r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'download\'}" ng-click="setView(\'download\')">\r\n\t\t<button class="undecorated">Download</button>\r\n\t</div>\r\n\t<!-- \r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'search\'}" ng-click="setView(\'search\')">\r\n\t\t<button class="undecorated">Search</button>\r\n\t</div>\r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'maps\'}" ng-click="setView(\'maps\')">\r\n\t\t<button class="undecorated">Layers</button>\r\n\t</div>\r\n\t-->\r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'glossary\'}" ng-click="setView(\'glossary\')">\r\n\t\t<button class="undecorated">Glossary</button>\r\n\t</div>\r\n\t<div class="paneTabItem" ng-class="{\'bold\': view == \'help\'}" ng-click="setView(\'help\')">\r\n\t\t<button class="undecorated">Help</button>\r\n\t</div>\r\n</div>\r\n'),t.put("common/navigation/altthemes.html",'<span class="altthemes-container">\r\n\t<span ng-repeat="item in themes | altthemesMatchCurrent : current">\r\n       <a title="{{item.label}}" ng-href="{{item.url}}" class="altthemesItemCompact" target="_blank">\r\n         <span class="altthemes-icon" ng-class="item.className"></span>\r\n       </a>\r\n    </li>\r\n</span>'),t.put("common/reset/reset.html",'<button type="button" class="map-tool-toggle-btn" ng-click="reset()" title="Reset page">\r\n   <span class="hidden-sm">Reset</span>\r\n   <i class="fa fa-lg fa-refresh"></i>\r\n</button>'),t.put("common/search/basin.html",'<div class="btn-group pull-left radSearch" style="position:relative;width:27em;opacity:0.9">\r\n\t<div class="input-group" style="width:100%;">\r\n\t\t<input type="text" size="32" class="form-control" style="border-top-right-radius:4px;border-bottom-right-radius:4px;"\r\n\t\t\t\tng-keyup="keyup($event)" ng-focus="changing()" ng-model="nameFilter" placeholder="Find a basin of interest">\r\n\t\t<div class="input-group-btn"></div>\r\n\t</div>\r\n\t<div style="width:26em; position:absolute;left:15px">\r\n\t\t<div class="row" ng-repeat="region in basinData.basins | basinFilterList : nameFilter : 10 | orderBy : \'name\'"\r\n\t\t\t\tstyle="background-color:white;">\r\n\t\t\t<div class="col-md-12 rw-sub-list-trigger">\r\n\t\t\t\t<button class="undecorated zoomButton" ng-click="zoomToLocation(region);">{{region.name}}</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("common/search/catchment.html",'<div class="btn-group pull-left radSearch" style="position:relative;width:27em;opacity:0.9">\r\n\t<div class="input-group" style="width:100%;">\r\n\t\t<input type="text" size="32" class="form-control" style="border-top-right-radius:4px;border-bottom-right-radius:4px;"\r\n\t\t\t\tng-keyup="keyup($event)" ng-focus="changing()" ng-model="nameFilter" placeholder="Find a catchment of interest">\r\n\t\t<div class="input-group-btn"></div>\r\n\t</div>\r\n\t<div style="width:26em; position:absolute;left:15px">\r\n\t\t<div class="row" ng-repeat="region in catchmentData.catchments | catchmentFilterList : nameFilter : 10 | orderBy : \'name\'"\r\n\t\t\t\tstyle="background-color:white;">\r\n\t\t\t<div class="col-md-12 rw-sub-list-trigger">\r\n\t\t\t\t<button class="undecorated zoomButton" ng-click="zoomToLocation(region);">{{region.name}}</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>'),t.put("common/side-panel/trigger.html",'<button ng-click="toggle()" type="button" class="map-tool-toggle-btn">\r\n   <span class="hidden-sm">{{name}}</span>\r\n   <ng-transclude></ng-transclude>\r\n   <i class="fa fa-lg" ng-class="iconClass"></i>\r\n</button>'),t.put("common/toolbar/toolbar.html",'<div icsm-toolbar>\r\n\t<div class="row toolBarGroup">\r\n\t\t<div class="btn-group searchBar" ng-show="root.whichSearch != \'region\'">\r\n\t\t\t<div class="input-group" geo-search>\r\n\t\t\t\t<input type="text" ng-autocomplete ng-model="values.from.description" options=\'{country:"au"}\'\r\n\t\t\t\t\t\t\tsize="32" title="Select a locality to pan the map to." class="form-control" aria-label="...">\r\n\t\t\t\t<div class="input-group-btn">\r\n    \t\t\t\t<button ng-click="zoom(false)" exp-ga="[\'send\', \'event\', \'icsm\', \'click\', \'zoom to location\']"\r\n\t\t\t\t\t\tclass="btn btn-default"\r\n\t\t\t\t\t\ttitle="Pan and potentially zoom to location."><i class="fa fa-search"></i></button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="pull-right">\r\n\t\t\t<div class="btn-toolbar radCore" role="toolbar"  icsm-toolbar>\r\n\t\t\t\t<div class="btn-group">\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class="btn-toolbar" style="margin:right:10px;display:inline-block">\r\n\t\t\t\t<div class="btn-group" title="{{overlaytitle}}">\r\n\t\t\t\t\t<span class="btn btn-default" common-baselayer-control max-zoom="16"></span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>')}]);